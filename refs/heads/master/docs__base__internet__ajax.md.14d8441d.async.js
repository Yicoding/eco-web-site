(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[23],{"+BxK":function(e,n,t){"use strict";t.r(n);var a=t("q1tI"),l=t.n(a),r=t("dEAq"),c=t("H1Ra");t("JjdP");n["default"]=e=>(l.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&r["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"markdown"},l.a.createElement("h1",{id:"ajax"},l.a.createElement(r["AnchorLink"],{to:"#ajax","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"ajax"),l.a.createElement("h2",{id:"1ajax-\u7684\u4f18\u70b9"},l.a.createElement(r["AnchorLink"],{to:"#1ajax-\u7684\u4f18\u70b9","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1.AJAX \u7684\u4f18\u70b9"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"\u53ef\u4ee5\u65e0\u9700\u5237\u65b0\u9875\u9762\u800c\u4e0e\u670d\u52a1\u5668\u7aef\u8fdb\u884c\u901a\u4fe1")),l.a.createElement("li",null,l.a.createElement("p",null,"\u5141\u8bb8\u4f60\u6839\u636e\u7528\u6237\u4e8b\u4ef6\u6765\u66f4\u65b0\u90e8\u5206\u9875\u9762\u5185\u5bb9"))),l.a.createElement("h2",{id:"2ajax-\u7684\u7f3a\u70b9"},l.a.createElement(r["AnchorLink"],{to:"#2ajax-\u7684\u7f3a\u70b9","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2.AJAX \u7684\u7f3a\u70b9"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"\u6ca1\u6709\u6d4f\u89c8\u5386\u53f2\uff0c\u4e0d\u80fd\u56de\u9000")),l.a.createElement("li",null,l.a.createElement("p",null,"\u5b58\u5728\u8de8\u57df\u95ee\u9898(\u540c\u6e90)")),l.a.createElement("li",null,l.a.createElement("p",null,"SEO \u4e0d\u53cb\u597d"))),l.a.createElement("h2",{id:"3\u521b\u5efa"},l.a.createElement(r["AnchorLink"],{to:"#3\u521b\u5efa","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"3.\u521b\u5efa"),l.a.createElement(c["a"],{code:"let xhr;\nif (window.XMLHttpRequest) {\n  xhr = new XMLHttpRequest();\n} else {\n  // IE6\u517c\u5bb9\n  xhr = new ActiveXObject('Microsoft.XMLHTTP');\n}",lang:"js"}),l.a.createElement("h2",{id:"4open-\u65b9\u6cd5\u5f00\u542f\u8bf7\u6c42"},l.a.createElement(r["AnchorLink"],{to:"#4open-\u65b9\u6cd5\u5f00\u542f\u8bf7\u6c42","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"4.open \u65b9\u6cd5\u5f00\u542f\u8bf7\u6c42"),l.a.createElement("blockquote",null,l.a.createElement("p",null,"xhr.open(method, url, boolean)")),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"method\uff1a\u8bf7\u6c42\u65b9\u6cd5")),l.a.createElement("li",null,l.a.createElement("p",null,"url\uff1a\u8bf7\u6c42\u5730\u5740")),l.a.createElement("li",null,l.a.createElement("p",null,"boolean\uff1a\u662f\u5426\u5f02\u6b65\u53d1\u9001\u8bf7\u6c42\uff0c\u9ed8\u8ba4\u4e3a true \u5f02\u6b65"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u540c\u6b65\u6267\u884c\uff0c\u4ee3\u7801\u4f1a\u5361\u5728 xhr.send()\u8fd9\u4e00\u6b65\uff0c\u7b49\u5230\u6240\u6709\u7684\u6570\u636e\u90fd\u4f20\u8f93\u5b8c\u6210\uff0c\u624d\u4f1a\u5f80\u4e0b\u6267\u884c")))),l.a.createElement(c["a"],{code:"xhr.open('GET', 'http://xxx/getInfo', true);",lang:"js"}),l.a.createElement("h2",{id:"5setrequestheader\u65b9\u6cd5\u8bbe\u7f6e\u8bf7\u6c42\u5934"},l.a.createElement(r["AnchorLink"],{to:"#5setrequestheader\u65b9\u6cd5\u8bbe\u7f6e\u8bf7\u6c42\u5934","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"5.setRequestHeader()\u65b9\u6cd5\u8bbe\u7f6e\u8bf7\u6c42\u5934"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u6b64\u65b9\u6cd5\u5fc5\u987b\u5728 open() \u65b9\u6cd5\u548c send() \u4e4b\u95f4\u8c03\u7528")),l.a.createElement("blockquote",null,l.a.createElement("p",null,"xhr.setRequestHeader(header, value)")),l.a.createElement(c["a"],{code:"xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');",lang:"js"}),l.a.createElement("h2",{id:"6send-\u65b9\u6cd5\u53d1\u9001\u8bf7\u6c42"},l.a.createElement(r["AnchorLink"],{to:"#6send-\u65b9\u6cd5\u53d1\u9001\u8bf7\u6c42","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"6.send \u65b9\u6cd5\u53d1\u9001\u8bf7\u6c42"),l.a.createElement("blockquote",null,l.a.createElement("p",null,"xhr.send(body)")),l.a.createElement("ul",null,l.a.createElement("li",null,"body\uff1a\u5728 XHR \u8bf7\u6c42\u4e2d\u8981\u53d1\u9001\u7684\u6570\u636e\u4f53\uff0c\u5982\u679c\u662f get \u65b9\u6cd5\uff0c\u65e0\u9700\u8bbe\u7f6e\u6570\u636e\u4f53\uff0c\u53ef\u4ee5\u4f20 null \u6216\u8005\u4e0d\u4f20\u53c2")),l.a.createElement(c["a"],{code:"// get\u8bf7\u6c42\nxhr.send(null);\n\n// post\u8bf7\u6c42\n// \u7b2c\u4e00\u79cd\u65b9\u6cd5\n// post\u8bf7\u6c42\uff0c\u5fc5\u987b\u8981\u8bbe\u7f6e\u8bf7\u6c42\u5934\nxhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n// \u6267\u884c\u53d1\u9001\nxhr.send('name=bb&age=23&class=2');\n\n// \u7b2c\u4e8c\u79cd\u65b9\u6cd5\nxhr.setRequestHeader('Content-Type', 'application/json');\n// json\u6570\u636e\u683c\u5f0f\nxhr.send('{\"name\":\"bn\",\"age\":23,\"class\":1}');\n\n// \u7b2c\u4e09\u79cd\u65b9\u6cd5\nxhr.setRequestHeader('Content-Type', 'application/json');\n// \u5bf9\u8c61\u8f6c\u5b57\u7b26\u4e32\nxhr.send(\n  JSON.stringify({\n    name: 'nn',\n    age: 12,\n    class: 2,\n  }),\n);",lang:"js"}),l.a.createElement("h2",{id:"7readystate-\u5c5e\u6027"},l.a.createElement(r["AnchorLink"],{to:"#7readystate-\u5c5e\u6027","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"7.readyState \u5c5e\u6027"),l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{align:"center"},"readyState"),l.a.createElement("th",{align:"center"},"\u72b6\u6001\u63cf\u8ff0"),l.a.createElement("th",{align:"left"},"\u8bf4\u660e"))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",{align:"center"},"0"),l.a.createElement("td",{align:"center"},"\u672a\u521d\u59cb\u5316"),l.a.createElement("td",{align:"left"},"\u5c1a\u672a\u8c03\u7528 open()\u65b9\u6cd5")),l.a.createElement("tr",null,l.a.createElement("td",{align:"center"},"1"),l.a.createElement("td",{align:"center"},"\u542f\u52a8"),l.a.createElement("td",{align:"left"},"\u5df2\u7ecf\u8c03\u7528 open()\u65b9\u6cd5\uff0c\u4f46\u672a\u8c03\u7528 send()\u65b9\u6cd5")),l.a.createElement("tr",null,l.a.createElement("td",{align:"center"},"2"),l.a.createElement("td",{align:"center"},"\u53d1\u9001"),l.a.createElement("td",{align:"left"},"\u5df2\u7ecf\u8c03\u7528 send()\u65b9\u6cd5\uff0c\u4f46\u5c1a\u672a\u63a5\u53d7\u5230\u54cd\u5e94")),l.a.createElement("tr",null,l.a.createElement("td",{align:"center"},"3"),l.a.createElement("td",{align:"center"},"\u63a5\u6536"),l.a.createElement("td",{align:"left"},"\u5df2\u7ecf\u6536\u5230\u90e8\u5206\u54cd\u5e94\u6570\u636e")),l.a.createElement("tr",null,l.a.createElement("td",{align:"center"},"4"),l.a.createElement("td",{align:"center"},"\u5b8c\u6210"),l.a.createElement("td",{align:"left"},"\u5df2\u7ecf\u63a5\u6536\u5230\u5168\u90e8\u54cd\u5e94\u6570\u636e\uff0c\u800c\u4e14\u5df2\u7ecf\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u4f7f\u7528\u4e86")))),l.a.createElement("h2",{id:"8\u5904\u7406\u56de\u8c03"},l.a.createElement(r["AnchorLink"],{to:"#8\u5904\u7406\u56de\u8c03","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"8.\u5904\u7406\u56de\u8c03"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"\u4e00\u822c\u90fd\u662f\u5728 readyState \u503c\u4e3a ",l.a.createElement("code",null,"4")," \u65f6\uff0c\u6267\u884c\u54cd\u5e94\u7684\u540e\u7eed\u903b\u8f91")),l.a.createElement("li",null,l.a.createElement("p",null,"\u4e3a\u4e86\u8ba9\u4e8b\u4ef6\u66f4\u52a0\u53ef\u9760\uff08\u4e00\u5b9a\u89e6\u53d1\uff09\uff0c\u5728\u53d1\u9001\u8bf7\u6c42 send()\u4e4b\u524d\uff0c\u4e00\u5b9a\u662f\u5148\u6ce8\u518c onreadystatechange \u4e8b\u4ef6"))),l.a.createElement(c["a"],{code:"xhr.onreadystatechange = function () {\n  if (xhr.readyState === 4) {\n    if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {\n      console.log('\u8bf7\u6c42\u6210\u529f');\n    } else {\n      console.log('\u8bf7\u6c42\u5931\u8d25');\n    }\n  }\n};\n\nxhr.send('name=mh&age=18');",lang:"js"}),l.a.createElement("h2",{id:"9\u8d85\u65f6\u5904\u7406"},l.a.createElement(r["AnchorLink"],{to:"#9\u8d85\u65f6\u5904\u7406","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"9.\u8d85\u65f6\u5904\u7406"),l.a.createElement(c["a"],{code:"xhr.timeout = 2000;\n// \u8d85\u65f6\u56de\u8c03\nxhr.ontimeout = function () {\n  alert('\u7f51\u7edc\u8f83\u6162\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01');\n};",lang:"js"}),l.a.createElement("h2",{id:"10\u7f51\u7edc\u5f02\u5e38\u5904\u7406"},l.a.createElement(r["AnchorLink"],{to:"#10\u7f51\u7edc\u5f02\u5e38\u5904\u7406","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"10.\u7f51\u7edc\u5f02\u5e38\u5904\u7406"),l.a.createElement(c["a"],{code:"xhr.onerror = function () {\n  alert('\u7f51\u7edc\u5f02\u5e38\uff01');\n};",lang:"js"}),l.a.createElement("h2",{id:"11\u53d6\u6d88\u8bf7\u6c42"},l.a.createElement(r["AnchorLink"],{to:"#11\u53d6\u6d88\u8bf7\u6c42","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"11.\u53d6\u6d88\u8bf7\u6c42"),l.a.createElement(c["a"],{code:"xhr.abort();",lang:"js"}),l.a.createElement("h2",{id:"12\u8868\u5355"},l.a.createElement(r["AnchorLink"],{to:"#12\u8868\u5355","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"12.\u8868\u5355"),l.a.createElement(c["a"],{code:"const form = new FormData();\nform.append('image', file);",lang:"js"}),l.a.createElement("h2",{id:"13\u5c01\u88c5-ajax"},l.a.createElement(r["AnchorLink"],{to:"#13\u5c01\u88c5-ajax","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"13.\u5c01\u88c5 ajax"),l.a.createElement(c["a"],{code:"/* {string} method \u8bf7\u6c42\u65b9\u6cd5\n  {string} url \u8bf7\u6c42\u5730\u5740\n  {object} params get\u8bf7\u6c42\u53c2\u6570\n  {object} data post\u8bf7\u6c42body\n  {boolean} isAsync\u662f\u5426\u8bbe\u7f6e\u4e3a\u540c\u6b65\u8bf7\u6c42\n  {number} timeout\u8d85\u65f6\u65f6\u95f4\u8bbe\u7f6e\n*/\nfunction ajax({\n  method,\n  url,\n  params,\n  data = null,\n  isAsync,\n  timeout = 40 * 1000,\n}) {\n  return new Promise((resolve, reject) => {\n    // \u521b\u5efaxhr\u5bf9\u8c61\uff0c\u517c\u5bb9\u5199\u6cd5\n    const xhr = window.XMLHttpRequest\n      ? new XMLHttpRequest()\n      : new ActiveXObject('Microsoft.XMLHTTP');\n    // \u5c06method\u8f6c\u6362\u6210\u5927\u5199\n    method = method.toUpperCase();\n    // \u5904\u7406get\u8bf7\u6c42\u53c2\u6570\n    if (method === 'GET') {\n      const str = Object.keys(params)\n        .map((k) => {\n          return `${k}=${params[k]}`;\n        })\n        .join('&');\n      url += `?${str}`;\n    }\n    xhr.open(method, url, isAsync);\n\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState === 4) {\n        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {\n          console.log('\u8bf7\u6c42\u6210\u529f');\n          resolve();\n        } else {\n          console.log('\u8bf7\u6c42\u5931\u8d25');\n          reject();\n        }\n      }\n    };\n    xhr.timeout = timeout;\n    // \u8d85\u65f6\u56de\u8c03\n    xhr.ontimeout = function () {\n      reject();\n      alert('\u7f51\u7edc\u8f83\u6162\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01');\n    };\n\n    xhr.onerror = function () {\n      reject();\n      alert('\u7f51\u7edc\u5f02\u5e38\uff01');\n    };\n\n    if (method === 'GET') {\n      xhr.send(null);\n    }\n\n    // \u5904\u7406post\u8bf7\u6c42\n    if (method === 'POST') {\n      xhr.setRequestHeader('Content-Type', 'application/json');\n      xhr.send(JSON.stringify(data));\n    }\n  });\n}",lang:"js"}))))},JjdP:function(e,n,t){"use strict";t.r(n),n["default"]={}},Zs1V:function(e){e.exports=JSON.parse("{}")}}]);