(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[156],{"4tVz":function(e,n,t){"use strict";t.r(n);var a=t("q1tI"),l=t.n(a),c=t("dEAq"),r=t("H1Ra");t("JjdP");n["default"]=e=>(l.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&c["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"markdown"},l.a.createElement("h1",{id:"\u72b6\u6001\u7ba1\u7406-redux"},l.a.createElement(c["AnchorLink"],{to:"#\u72b6\u6001\u7ba1\u7406-redux","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u72b6\u6001\u7ba1\u7406 redux"),l.a.createElement("h2",{id:"1\u72b6\u6001\u7ba1\u7406\u5e94\u7528\u573a\u666f"},l.a.createElement(c["AnchorLink"],{to:"#1\u72b6\u6001\u7ba1\u7406\u5e94\u7528\u573a\u666f","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1.\u72b6\u6001\u7ba1\u7406\u5e94\u7528\u573a\u666f"),l.a.createElement("h3",{id:"1\u7ec4\u4ef6\u4e4b\u95f4\u5171\u7528\u6570\u636e"},l.a.createElement(c["AnchorLink"],{to:"#1\u7ec4\u4ef6\u4e4b\u95f4\u5171\u7528\u6570\u636e","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1\uff09\u7ec4\u4ef6\u4e4b\u95f4\u5171\u7528\u6570\u636e"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u5e94\u7528\u521d\u59cb\u5316\u65f6\u5019\uff0c",l.a.createElement("code",null,"\u53ea\u8bf7\u6c42\u4e00\u6b21"),"\u6570\u636e\uff0c\u7136\u540e\u901a\u8fc7\u72b6\u6001\u7ba1\u7406\u628a\u6570\u636e\u5b58\u8d77\u6765\uff0c\u9700\u8981\u6570\u636e\u7684\u7ec4\u4ef6\u53ea\u9700\u8981\u4ece\u72b6\u6001\u7ba1\u7406\u4e2d\u2018\u62ff\u2019\u5c31\u53ef\u4ee5\u4e86")),l.a.createElement("h3",{id:"2\u590d\u6742\u7ec4\u4ef6\u4e4b\u95f4\u901a\u4fe1"},l.a.createElement(c["AnchorLink"],{to:"#2\u590d\u6742\u7ec4\u4ef6\u4e4b\u95f4\u901a\u4fe1","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2\uff09\u590d\u6742\u7ec4\u4ef6\u4e4b\u95f4\u901a\u4fe1"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"\u5bf9\u4e8e\u5d4c\u5957\u6bd4\u8f83\u6df1\u7684\u7ec4\u4ef6\u4e4b\u95f4\u7684\u901a\u4fe1")),l.a.createElement("li",null,l.a.createElement("p",null,"B \u7ec4\u4ef6\u5411 H \u7ec4\u4ef6\u4f20\u9012\u67d0\u4e9b\u4fe1\u606f\uff1a"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u53ef\u4ee5\u628a B \u7ec4\u4ef6\u7684\u4fe1\u606f\u4f20\u9012\u7ed9\u72b6\u6001\u7ba1\u7406\u5c42\uff0cH \u7ec4\u4ef6\u8fde\u63a5\u72b6\u6001\u7ba1\u7406\u5c42\uff0c\u518d\u7531\u72b6\u6001\u7ba1\u7406\u5c42\u901a\u77e5 H \u7ec4\u4ef6"),l.a.createElement("li",null,"\u8fd9\u6837\u5c31\u672c\u8d28\u89e3\u51b3\u4e86\u7ec4\u4ef6\u901a\u4fe1\u95ee\u9898")))),l.a.createElement("h2",{id:"2react-reduxreduxreact-\u4e09\u8005\u5173\u7cfb"},l.a.createElement(c["AnchorLink"],{to:"#2react-reduxreduxreact-\u4e09\u8005\u5173\u7cfb","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2.React-Redux,Redux,React \u4e09\u8005\u5173\u7cfb"),l.a.createElement("p",null,l.a.createElement("img",{src:t("L/18"),alt:"image"})),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,l.a.createElement("code",null,"Redux"),"\uff1a Redux \u662f\u4e00\u4e2a\u5e94\u7528\u72b6\u6001\u7ba1\u7406 js \u5e93\uff0c\u672c\u8eab\u548c React \u662f\u6ca1\u6709\u5173\u7cfb\u7684"),l.a.createElement("ul",null,l.a.createElement("li",null,"Redux \u53ef\u4ee5\u5e94\u7528\u4e8e\u5176\u4ed6\u6846\u67b6\u6784\u5efa\u7684\u524d\u7aef\u5e94\u7528\uff0c\u751a\u81f3\u4e5f\u53ef\u4ee5\u5e94\u7528\u4e8e Vue \u4e2d"))),l.a.createElement("li",null,l.a.createElement("p",null,l.a.createElement("code",null,"React-Redux"),"\uff1aReact-Redux \u662f\u8fde\u63a5 React \u5e94\u7528\u548c Redux \u72b6\u6001\u7ba1\u7406\u7684",l.a.createElement("code",null,"\u6865\u6881")),l.a.createElement("ul",null,l.a.createElement("li",null,"React-redux \u4e3b\u8981\u4e13\u6ce8\u4e24\u4ef6\u4e8b\uff1a",l.a.createElement("ul",null,l.a.createElement("li",null,"\u4e00\u662f\u5982\u4f55\u5411 React \u5e94\u7528\u4e2d",l.a.createElement("code",null,"\u6ce8\u5165")," redux \u4e2d\u7684 ",l.a.createElement("code",null,"Store")),l.a.createElement("li",null,"\u4e8c\u662f\u5982\u4f55\u6839\u636e Store \u7684\u6539\u53d8\uff0c\u628a\u6d88\u606f",l.a.createElement("code",null,"\u6d3e\u53d1"),"\u7ed9\u5e94\u7528\u4e2d\u9700\u8981\u72b6\u6001\u7684\u6bcf\u4e00\u4e2a\u7ec4\u4ef6")))))),l.a.createElement("h2",{id:"3redux"},l.a.createElement(c["AnchorLink"],{to:"#3redux","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"3.Redux"),l.a.createElement("h3",{id:"1\u4e09\u5927\u539f\u5219"},l.a.createElement(c["AnchorLink"],{to:"#1\u4e09\u5927\u539f\u5219","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1\uff09\u4e09\u5927\u539f\u5219"),l.a.createElement("ul",null,l.a.createElement("li",null,"1.",l.a.createElement("code",null,"\u5355\u5411\u6570\u636e\u6d41"),"\uff1a\u6574\u4e2a redux \uff0c\u6570\u636e\u6d41\u5411\u90fd\u662f\u5355\u5411\u7684")),l.a.createElement("p",null,l.a.createElement("img",{src:t("M7xk"),alt:"image"})),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"2.",l.a.createElement("code",null,"state \u53ea\u8bfb"),"\uff1a\u5728 Redux \u4e2d\u4e0d\u80fd\u901a\u8fc7\u76f4\u63a5\u6539\u53d8 state \uff0c\u6765\u8ba9\u72b6\u6001\u53d1\u751f\u53d8\u5316\uff0c\u5982\u679c\u60f3\u8981\u6539\u53d8 state \uff0c\u90a3\u5c31\u5fc5\u987b",l.a.createElement("code",null,"\u89e6\u53d1"),"\u4e00\u6b21 ",l.a.createElement("code",null,"action")," \uff0c",l.a.createElement("code",null,"\u901a\u8fc7 action \u6267\u884c"),"\u6bcf\u4e2a ",l.a.createElement("code",null,"reducer"))),l.a.createElement("li",null,l.a.createElement("p",null,"3.",l.a.createElement("code",null,"\u7eaf\u51fd\u6570\u6267\u884c"),"\uff1a\u6bcf\u4e00\u4e2a ",l.a.createElement("code",null,"reducer")," \u90fd\u662f\u4e00\u4e2a",l.a.createElement("code",null,"\u7eaf\u51fd\u6570"),"\uff0c\u91cc\u9762\u4e0d\u8981\u6267\u884c\u4efb\u4f55\u526f\u4f5c\u7528\uff0c\u8fd4\u56de\u7684\u503c\u4f5c\u4e3a\u65b0\u7684 state \uff0cstate \u6539\u53d8\u4f1a\u89e6\u53d1 store \u4e2d\u7684 ",l.a.createElement("code",null,"subscribe")))),l.a.createElement("h3",{id:"2\u53d1\u5e03\u8ba2\u9605\u601d\u60f3"},l.a.createElement(c["AnchorLink"],{to:"#2\u53d1\u5e03\u8ba2\u9605\u601d\u60f3","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2\uff09\u53d1\u5e03\u8ba2\u9605\u601d\u60f3"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"redux")," \u53ef\u4ee5\u4f5c\u4e3a",l.a.createElement("code",null,"\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f"),"\u7684\u4e00\u4e2a\u5177\u4f53\u5b9e\u73b0"),l.a.createElement("li",null,"redux \u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a ",l.a.createElement("code",null,"store")," \uff0c\u91cc\u9762",l.a.createElement("code",null,"\u4fdd\u5b58"),"\u4e86",l.a.createElement("code",null,"\u72b6\u6001\u4fe1\u606f")),l.a.createElement("li",null,l.a.createElement("code",null,"\u6539\u53d8 store")," \u7684\u65b9\u6cd5 ",l.a.createElement("code",null,"dispatch")," \uff0c\u4ee5\u53ca",l.a.createElement("code",null,"\u8ba2\u9605 store")," \u53d8\u5316\u7684\u65b9\u6cd5 ",l.a.createElement("code",null,"subscribe"))),l.a.createElement("h3",{id:"3\u4e2d\u95f4\u4ef6\u601d\u60f3"},l.a.createElement(c["AnchorLink"],{to:"#3\u4e2d\u95f4\u4ef6\u601d\u60f3","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"3\uff09\u4e2d\u95f4\u4ef6\u601d\u60f3"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"1.",l.a.createElement("code",null,"redux")," \u5e94\u7528\u4e86\u524d\u7aef\u9886\u57df\u4e3a\u6570\u4e0d\u591a\u7684\u4e2d\u95f4\u4ef6 ",l.a.createElement("code",null,"compose"))),l.a.createElement("li",null,l.a.createElement("p",null,"2.",l.a.createElement("code",null,"\u4f5c\u7528"),"\uff1a",l.a.createElement("code",null,"\u5f3a\u5316 dispatch")),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"\u4f20\u7edf\u7684 ",l.a.createElement("code",null,"dispatch")," \u662f",l.a.createElement("code",null,"\u4e0d\u652f\u6301\u5f02\u6b65"),"\u7684\uff0c\u4f46\u662f\u53ef\u4ee5\u9488\u5bf9 Redux \u505a",l.a.createElement("code",null,"\u5f3a\u5316")),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"redux-thunk"),"\u3001",l.a.createElement("code",null,"redux-actions")),l.a.createElement("li",null,l.a.createElement("code",null,"dvajs"),"\uff1a\u4e5f\u5199\u4e86\u4e00\u4e2a redux \u652f\u6301 promise \u7684\u4e2d\u95f4\u4ef6"))))),l.a.createElement("li",null,l.a.createElement("p",null,"3.",l.a.createElement("code",null,"compose")," \u5b9e\u73b0\uff1a"),l.a.createElement(r["a"],{code:"const compose = (...funcs) => {\n  return funcs.reduce((f, g) => (x) => f(g(x)));\n};",lang:"js"}),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"funcs")," \u4e3a\u4e2d\u95f4\u4ef6\u7ec4\u6210\u7684",l.a.createElement("code",null,"\u6570\u7ec4``\uff0ccompose")," \u901a\u8fc7\u6570\u7ec4\u7684 ",l.a.createElement("code",null,"reduce")," \u65b9\u6cd5\uff0c\u5b9e\u73b0\u6267\u884c\u6bcf\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u5f3a\u5316 ",l.a.createElement("code",null,"dispatch"))))),l.a.createElement("h3",{id:"4createstore"},l.a.createElement(c["AnchorLink"],{to:"#4createstore","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"4\uff09createStore"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u901a\u8fc7 createStore \u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a Store"),l.a.createElement("li",null,"\u4f7f\u7528\u8005\u53ef\u4ee5\u5c06\u8fd9\u4e2a Store \u4fdd\u5b58\u4f20\u9012\u7ed9 React \u5e94\u7528")),l.a.createElement(r["a"],{code:"const Store = createStore(rootReducer, initialState, middleware);",lang:"js"}),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"reducers"),"\uff1a redux \u7684 reducer \uff0c\u5982\u679c\u6709\u591a\u4e2a\u90a3\u4e48\u53ef\u4ee5\u8c03\u7528 combineReducers \u5408\u5e76"),l.a.createElement("li",null,l.a.createElement("code",null,"initialState"),"\uff1a\u521d\u59cb\u5316\u7684 state"),l.a.createElement("li",null,l.a.createElement("code",null,"middleware"),"\uff1a\u5982\u679c\u6709\u4e2d\u95f4\u4ef6\uff0c\u90a3\u4e48\u5b58\u653e redux \u4e2d\u95f4\u4ef6")),l.a.createElement("h3",{id:"5combinereducers"},l.a.createElement(c["AnchorLink"],{to:"#5combinereducers","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"5\uff09combineReducers"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u6b63\u5e38\u72b6\u6001\u53ef\u4ee5\u4f1a\u6709\u591a\u4e2a reducer \uff0c",l.a.createElement("code",null,"combineReducers")," \u53ef\u4ee5",l.a.createElement("code",null,"\u5408\u5e76\u591a\u4e2a reducer"))),l.a.createElement(r["a"],{code:"/* \u5c06 number \u548c PersonalInfo \u4e24\u4e2areducer\u5408\u5e76   */\nconst rootReducer = combineReducers({\n  number: numberReducer,\n  info: InfoReducer,\n});",lang:"js"}),l.a.createElement("h3",{id:"6applymiddleware"},l.a.createElement(c["AnchorLink"],{to:"#6applymiddleware","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"6\uff09applyMiddleware"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"applyMiddleware")," \u7528\u4e8e",l.a.createElement("code",null,"\u6ce8\u518c\u4e2d\u95f4\u4ef6")),l.a.createElement("li",null,"\u652f\u6301\u591a\u4e2a\u53c2\u6570"),l.a.createElement("li",null,"\u6bcf\u4e00\u4e2a\u53c2\u6570\u90fd\u662f\u4e00\u4e2a\u4e2d\u95f4\u4ef6"),l.a.createElement("li",null,"\u6bcf\u6b21\u89e6\u53d1 action \uff0c\u4e2d\u95f4\u4ef6\u4f9d\u6b21\u6267\u884c")),l.a.createElement(r["a"],{code:"const middleware = applyMiddleware(logMiddleware);",lang:"js"}),l.a.createElement("h2",{id:"4redux-\u4f7f\u7528"},l.a.createElement(c["AnchorLink"],{to:"#4redux-\u4f7f\u7528","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"4.Redux \u4f7f\u7528"),l.a.createElement("h3",{id:"1\u7f16\u5199-reducer"},l.a.createElement(c["AnchorLink"],{to:"#1\u7f16\u5199-reducer","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1\uff09\u7f16\u5199 reducer"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"\u7ba1\u7406\u53d8\u91cf number")),l.a.createElement("li",null,l.a.createElement("p",null,"\u4fdd\u5b58\u4fe1\u606f info"))),l.a.createElement(r["a"],{code:"/* number Reducer */\nfunction numberReducer(state = 1, action) {\n  switch (action.type) {\n    case 'ADD':\n      return state + 1;\n    case 'DEL':\n      return state - 1;\n    default:\n      return state;\n  }\n}\n/* \u7528\u6237\u4fe1\u606freducer */\nfunction InfoReducer(state = {}, action) {\n  const { payload = {} } = action;\n  switch (action.type) {\n    case 'SET':\n      return {\n        ...state,\n        ...payload,\n      };\n    default:\n      return state;\n  }\n}",lang:"js"}),l.a.createElement("h3",{id:"2\u6ce8\u518c\u4e2d\u95f4\u4ef6"},l.a.createElement(c["AnchorLink"],{to:"#2\u6ce8\u518c\u4e2d\u95f4\u4ef6","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2\uff09\u6ce8\u518c\u4e2d\u95f4\u4ef6"),l.a.createElement("ul",null,l.a.createElement("li",null,"redux \u7684",l.a.createElement("code",null,"\u4e2d\u95f4\u4ef6"),"\u7684\u7f16\u5199\u65b9\u5f0f\uff0c",l.a.createElement("code",null,"\u672c\u8d28"),"\u4e0a\u5e94\u7528\u4e86",l.a.createElement("code",null,"\u51fd\u6570\u67ef\u91cc\u5316"))),l.a.createElement(r["a"],{code:"/* \u6253\u5370\u4e2d\u95f4\u4ef6 */\n/* \u7b2c\u4e00\u5c42\u5728 compose \u4e2d\u88ab\u6267\u884c */\nfunction logMiddleware() {\n  /* \u7b2c\u4e8c\u5c42\u5728reduce\u4e2d\u88ab\u6267\u884c */\n  return (next) => {\n    /* \u8fd4\u56de\u589e\u5f3a\u540e\u7684dispatch */\n    return (action) => {\n      const { type } = action;\n      console.log('\u53d1\u751f\u4e00\u6b21action:', type);\n      return next(action);\n    };\n  };\n}",lang:"js"}),l.a.createElement("h3",{id:"3\u751f\u6210-store"},l.a.createElement(c["AnchorLink"],{to:"#3\u751f\u6210-store","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"3\uff09\u751f\u6210 Store"),l.a.createElement(r["a"],{code:"/* \u6ce8\u518c\u4e2d\u95f4\u4ef6  */\nconst rootMiddleware = applyMiddleware(logMiddleware);\n/* \u6ce8\u518creducer */\nconst rootReducer = combineReducers({\n  number: numberReducer,\n  info: InfoReducer,\n});\n/* \u5408\u6210Store */\nconst Store = createStore(\n  rootReducer,\n  { number: 1, info: { name: null } },\n  rootMiddleware,\n);",lang:"js"}),l.a.createElement("h3",{id:"4\u9875\u9762\u4f7f\u7528"},l.a.createElement(c["AnchorLink"],{to:"#4\u9875\u9762\u4f7f\u7528","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"4\uff09\u9875\u9762\u4f7f\u7528"),l.a.createElement(r["a"],{code:"function Index() {\n  const [state, changeState] = useState(Store.getState());\n  useEffect(() => {\n    // \u8ba2\u9605store\n    const unSubscribe = Store.subscribe(() => {\n      changeState(Store.getState());\n    });\n    // \u89e3\u9664\u8ba2\u9605\n    return () => unSubscribe();\n  }, []);\n  return (\n    <div>\n      <p>{state.info.name ? `Name: ${state.info.name}` : '\u4f60\u7684\u540d\u5b57\u662f\uff1f'}</p>\n      <p>{state.info.mes ? state.info.mes : ' what do you say? '}</p>\n      <p>\u70b9\u8d5e\u6b21\u6570\uff1a{state.number}</p>\n      <button\n        onClick={() => {\n          Store.dispath({ type: 'ADD' });\n        }}\n      >\n        \u70b9\u8d5e\n      </button>\n      <button\n        onClick={() => {\n          Store.dispatch({\n            type: 'SET',\n            payload: { name: 'alien', mes: 'let us learn React!' },\n          });\n        }}\n      >\n        \u4fee\u6539\u4fe1\u606f\n      </button>\n    </div>\n  );\n}",lang:"js"}),l.a.createElement("h2",{id:"5react-redux-\u7528\u6cd5"},l.a.createElement(c["AnchorLink"],{to:"#5react-redux-\u7528\u6cd5","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"5.React-Redux \u7528\u6cd5"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"React-Redux \u662f\u6c9f\u901a React \u548c Redux \u7684",l.a.createElement("code",null,"\u6865\u6881")),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"1.\u63a5\u53d7 Redux \u7684 ",l.a.createElement("code",null,"Store"),"\uff0c\u5e76\u628a\u5b83\u5408\u7406",l.a.createElement("code",null,"\u5206\u914d"),"\u5230\u6240\u9700\u8981\u7684\u7ec4\u4ef6\u4e2d")),l.a.createElement("li",null,l.a.createElement("p",null,"2.\u8ba2\u9605 Store \u4e2d state \u7684\u6539\u53d8\uff0c\u4fc3\u4f7f",l.a.createElement("code",null,"\u6d88\u8d39"),"\u5bf9\u5e94\u7684 ",l.a.createElement("code",null,"state")," \u7684\u7ec4\u4ef6\u66f4\u65b0"))))),l.a.createElement("h3",{id:"1provider"},l.a.createElement(c["AnchorLink"],{to:"#1provider","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1\uff09Provider"),l.a.createElement("ul",null,l.a.createElement("li",null,"react-redux \u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a ",l.a.createElement("code",null,"Provider")," \u7ec4\u4ef6\uff0c\u53ef\u4ee5",l.a.createElement("code",null,"\u5168\u5c40\u6ce8\u5165")," redux \u4e2d\u7684 ",l.a.createElement("code",null,"store")),l.a.createElement("li",null,"\u4f7f\u7528\u65f6\u9700\u8981\u628a ",l.a.createElement("code",null,"Provider")," \u6ce8\u518c\u5230",l.a.createElement("code",null,"\u6839\u90e8\u7ec4\u4ef6"),"\u4e2d"),l.a.createElement("li",null,"Provider \u4f5c\u7528\u5c31\u662f",l.a.createElement("code",null,"\u4fdd\u5b58")," redux \u4e2d\u7684 ",l.a.createElement("code",null,"store")," \uff0c",l.a.createElement("code",null,"\u5206\u914d"),"\u7ed9\u6240\u6709\u9700\u8981 ",l.a.createElement("code",null,"state")," \u7684",l.a.createElement("code",null,"\u5b50\u5b59\u7ec4\u4ef6"))),l.a.createElement(r["a"],{code:"export default function Root() {\n  return (\n    <Provider store={Store}>\n      <Index />\n    </Provider>\n  );\n}",lang:"js"}),l.a.createElement("h3",{id:"2connect"},l.a.createElement(c["AnchorLink"],{to:"#2connect","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2\uff09connect"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,l.a.createElement("code",null,"\u9ad8\u9636\u7ec4\u4ef6")," connect")),l.a.createElement("li",null,l.a.createElement("p",null,"\u4f5c\u7528\uff1a"),l.a.createElement("ul",null,l.a.createElement("li",null,"1.\u80fd\u591f\u4ece props \u4e2d",l.a.createElement("code",null,"\u83b7\u53d6"),"\u6539\u53d8 state \u7684\u65b9\u6cd5 Store.",l.a.createElement("code",null,"dispatch")),l.a.createElement("li",null,"2.\u5982\u679c connect \u6709",l.a.createElement("code",null,"\u7b2c\u4e00\u4e2a\u53c2\u6570"),"\uff0c\u90a3\u4e48\u4f1a\u5c06 redux state \u4e2d\u7684",l.a.createElement("code",null,"\u6570\u636e"),"\uff0c",l.a.createElement("code",null,"\u6620\u5c04\u5230"),"\u5f53\u524d\u7ec4\u4ef6\u7684 ",l.a.createElement("code",null,"props \u4e2d"),"\uff0c\u5b50\u7ec4\u4ef6\u53ef\u4ee5\u4f7f\u7528\u6d88\u8d39"),l.a.createElement("li",null,"3.\u5f53\u9700\u8981\u7684 state \uff0c\u6709\u53d8\u5316\u7684\u65f6\u5019\uff0c\u4f1a",l.a.createElement("code",null,"\u901a\u77e5"),"\u5f53\u524d\u7ec4\u4ef6",l.a.createElement("code",null,"\u66f4\u65b0"),"\uff0c\u91cd\u65b0",l.a.createElement("code",null,"\u6e32\u67d3\u89c6\u56fe")))),l.a.createElement("li",null,l.a.createElement("p",null,"\u53ef\u4ee5\u5229\u7528 connect \u63d0\u4f9b\u7684\u529f\u80fd\uff0c\u505a\u6570\u636e\u83b7\u53d6\uff0c\u6570\u636e\u901a\u4fe1\uff0c\u72b6\u6001\u6d3e\u53d1\u7b49\u64cd\u4f5c"))),l.a.createElement(r["a"],{code:"function connect(mapStateToProps?, mapDispatchToProps?, mergeProps?, options?)",lang:"js"}),l.a.createElement("p",null,l.a.createElement("strong",null,"\u2460mapStateToProps")),l.a.createElement("ul",null,l.a.createElement("li",null,"\u7ec4\u4ef6\u4f9d\u8d56 redux \u7684 ",l.a.createElement("code",null,"state"),"\uff0c",l.a.createElement("code",null,"\u6620\u5c04"),"\u5230\u4e1a\u52a1\u7ec4\u4ef6\u7684 ",l.a.createElement("code",null,"props \u4e2d"),"\uff0cstate \u6539\u53d8\u89e6\u53d1\uff0c\u4e1a\u52a1\u7ec4\u4ef6 props \u6539\u53d8\uff0c\u89e6\u53d1\u4e1a\u52a1\u7ec4\u4ef6\u66f4\u65b0\u89c6\u56fe"),l.a.createElement("li",null,"\u5f53\u8fd9\u4e2a\u53c2\u6570",l.a.createElement("code",null,"\u6ca1\u6709"),"\u7684\u65f6\u5019\uff0c\u5f53\u524d\u7ec4\u4ef6",l.a.createElement("code",null,"\u4e0d\u4f1a\u8ba2\u9605")," store \u7684\u6539\u53d8")),l.a.createElement(r["a"],{code:"const mapStateToProps = (state) => ({ number: state.number });",lang:"js"}),l.a.createElement("p",null,l.a.createElement("strong",null,"\u2461mapDispatchToProps")),l.a.createElement("ul",null,l.a.createElement("li",null,"\u5c06 redux \u4e2d\u7684 ",l.a.createElement("code",null,"dispatch")," \u65b9\u6cd5\uff0c",l.a.createElement("code",null,"\u6620\u5c04"),"\u5230\u4e1a\u52a1\u7ec4\u4ef6\u7684 ",l.a.createElement("code",null,"props \u4e2d"))),l.a.createElement(r["a"],{code:"const mapDispatchToProps = (dispatch) => {\n  return {\n    numberAdd: () => dispatch({ type: 'ADD' }),\n    setInfo: () => dispatch({ type: 'SET' }),\n  };\n};",lang:"js"}),l.a.createElement("p",null,l.a.createElement("strong",null,"\u2462mergeProps")),l.a.createElement(r["a"],{code:"/*\n * stateProps , state \u6620\u5c04\u5230 props \u4e2d\u7684\u5185\u5bb9\n * dispatchProps\uff0c dispatch \u6620\u5c04\u5230 props \u4e2d\u7684\u5185\u5bb9\u3002\n * ownProps \u7ec4\u4ef6\u672c\u8eab\u7684 props\n */\n(stateProps, dispatchProps, ownProps) => Object;\n\n// \u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u53c2\u6570\uff0c\u8fd4\u56de\n{ ...ownProps, ...stateProps, ...dispatchProps }",lang:"js"}),l.a.createElement("p",null,l.a.createElement("strong",null,"\u2463options")),l.a.createElement(r["a"],{code:"{\n  context?: Object,   // \u81ea\u5b9a\u4e49\u4e0a\u4e0b\u6587\n  pure?: boolean, // \u9ed8\u8ba4\u4e3a true , \u5f53\u4e3a true \u7684\u65f6\u5019 \uff0c\u9664\u4e86 mapStateToProps \u548c props ,\u5176\u4ed6\u8f93\u5165\u6216\u8005state \u6539\u53d8\uff0c\u5747\u4e0d\u4f1a\u66f4\u65b0\u7ec4\u4ef6\u3002\n  areStatesEqual?: Function, // \u5f53pure true , \u6bd4\u8f83\u5f15\u8fdbstore \u4e2dstate\u503c \u662f\u5426\u548c\u4e4b\u524d\u76f8\u7b49\u3002 (next: Object, prev: Object) => boolean\n  areOwnPropsEqual?: Function, // \u5f53pure true , \u6bd4\u8f83 props \u503c, \u662f\u5426\u548c\u4e4b\u524d\u76f8\u7b49\u3002 (next: Object, prev: Object) => boolean\n  areStatePropsEqual?: Function, // \u5f53pure true , \u6bd4\u8f83 mapStateToProps \u540e\u7684\u503c \u662f\u5426\u548c\u4e4b\u524d\u76f8\u7b49\u3002  (next: Object, prev: Object) => boolean\n  areMergedPropsEqual?: Function, // \u5f53 pure \u4e3a true \u65f6\uff0c \u6bd4\u8f83 \u7ecf\u8fc7 mergeProps \u5408\u5e76\u540e\u7684\u503c \uff0c \u662f\u5426\u4e0e\u4e4b\u524d\u7b49  (next: Object, prev: Object) => boolean\n  forwardRef?: boolean, //\u5f53\u4e3atrue \u65f6\u5019,\u53ef\u4ee5\u901a\u8fc7ref \u83b7\u53d6\u88abconnect\u5305\u88f9\u7684\u7ec4\u4ef6\u5b9e\u4f8b\u3002\n}",lang:"js"}),l.a.createElement("h2",{id:"6react-redux-\u5b9e\u73b0\u72b6\u6001\u5171\u4eab"},l.a.createElement(c["AnchorLink"],{to:"#6react-redux-\u5b9e\u73b0\u72b6\u6001\u5171\u4eab","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"6.React-Redux \u5b9e\u73b0\u72b6\u6001\u5171\u4eab"),l.a.createElement("ul",null,l.a.createElement("li",null,"1.\u5728\u6839\u7ec4\u4ef6\u4e2d\u6ce8\u5165 store \uff0c\u5e76\u5728 useEffect \u4e2d\u6539\u53d8 state \u5185\u5bb9")),l.a.createElement(r["a"],{code:"export default function Root() {\n  React.useEffect(() => {\n    Store.dispatch({ type: 'ADD' });\n    Store.dispatch({\n      type: 'SET',\n      payload: { name: 'alien', mes: 'let us learn React!' },\n    });\n  }, []);\n  return (\n    <Provider store={Store}>\n      <Index />\n    </Provider>\n  );\n}",lang:"js"}),l.a.createElement("ul",null,l.a.createElement("li",null,"2.\u7136\u540e\u5728\u6574\u4e2a\u5e94\u7528\u4e2d\u5728\u60f3\u8981\u83b7\u53d6\u6570\u636e\u7684\u7ec4\u4ef6\u91cc\uff0c\u83b7\u53d6 state \u4e2d\u7684\u5185\u5bb9",l.a.createElement("ul",null,l.a.createElement("li",null,"\u901a\u8fc7 mapStateToProps \u83b7\u53d6\u6307\u5b9a state \u4e2d\u7684\u5185\u5bb9\uff0c\u7136\u540e\u6e32\u67d3\u89c6\u56fe")))),l.a.createElement(r["a"],{code:"import { connect } from 'react-redux';\n\nclass Index extends React.Component {\n  componentDidMount() {}\n  render() {\n    const { info, number } = this.props;\n    return (\n      <div>\n        <p>\n          {' '}\n          {info.name\n            ? `hello, my name is ${info.name}`\n            : 'what is your name'} ,{info.mes\n            ? info.mes\n            : ' what do you say? '}{' '}\n        </p>\n        \u70b9\u8d5e\u6b21\u6570 {number} <br />\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({ number: state.number, info: state.info });\n\nexport default connect(mapStateToProps)(Index);",lang:"js"}),l.a.createElement("h2",{id:"7react-redux-\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"},l.a.createElement(c["AnchorLink"],{to:"#7react-redux-\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"7.React-Redux \u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"),l.a.createElement("h3",{id:"1\u7ec4\u4ef6-a"},l.a.createElement(c["AnchorLink"],{to:"#1\u7ec4\u4ef6-a","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1\uff09\u7ec4\u4ef6 A"),l.a.createElement(r["a"],{code:"function ComponentA({ toCompB, compBsay }) {\n  /* \u7ec4\u4ef6A */\n  const [CompAsay, setCompAsay] = useState('');\n  return (\n    <div className=\"box\">\n      <p>\u6211\u662f\u7ec4\u4ef6A</p>\n      <div> B\u7ec4\u4ef6\u5bf9\u6211\u8bf4\uff1a{compBsay} </div>\n      \u6211\u5bf9B\u7ec4\u4ef6\u8bf4\uff1a\n      <input\n        placeholder=\"CompAsay\"\n        onChange={(e) => setCompAsay(e.target.value)}\n      />\n      <button onClick={() => toCompB(CompAsay)}>\u786e\u5b9a</button>\n    </div>\n  );\n}\n/* \u6620\u5c04state\u4e2dCompBsay  */\nconst CompAMapStateToProps = (state) => ({ compBsay: state.info.compBsay });\n/* \u6620\u5c04toCompB\u65b9\u6cd5\u5230props\u4e2d */\nconst CompAmapDispatchToProps = (dispatch) => ({\n  toCompB: (mes) => dispatch({ type: 'SET', payload: { compAsay: mes } }),\n});\n/* connect\u5305\u88c5\u7ec4\u4ef6A */\nexport const CompA = connect(\n  CompAMapStateToProps,\n  CompAmapDispatchToProps,\n)(ComponentA);",lang:"js"}),l.a.createElement("h3",{id:"2\u7ec4\u4ef6-b"},l.a.createElement(c["AnchorLink"],{to:"#2\u7ec4\u4ef6-b","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2\uff09\u7ec4\u4ef6 B"),l.a.createElement(r["a"],{code:"class ComponentB extends React.Component {\n  /* B\u7ec4\u4ef6 */\n  state = { compBsay: '' };\n  handleToA = () => {\n    this.props.dispatch({\n      type: 'SET',\n      payload: { compBsay: this.state.compBsay },\n    });\n  };\n  render() {\n    return (\n      <div className=\"box\">\n        <p>\u6211\u662f\u7ec4\u4ef6B</p>\n        <div> A\u7ec4\u4ef6\u5bf9\u6211\u8bf4\uff1a{this.props.compAsay} </div>\n        \u6211\u5bf9A\u7ec4\u4ef6\u8bf4\uff1a\n        <input\n          placeholder=\"CompBsay\"\n          onChange={(e) => this.setState({ compBsay: e.target.value })}\n        />\n        <button onClick={this.handleToA}>\u786e\u5b9a</button>\n      </div>\n    );\n  }\n}\n/* \u6620\u5c04state\u4e2d CompAsay  */\nconst CompBMapStateToProps = (state) => ({ compAsay: state.info.compAsay });\nexport const CompB = connect(CompBMapStateToProps)(ComponentB);",lang:"js"}),l.a.createElement("h2",{id:"8react-redux-\u539f\u7406"},l.a.createElement(c["AnchorLink"],{to:"#8react-redux-\u539f\u7406","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"8.React-Redux \u539f\u7406"),l.a.createElement("h3",{id:"1provider-\u6ce8\u5165-store"},l.a.createElement(c["AnchorLink"],{to:"#1provider-\u6ce8\u5165-store","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1\uff09Provider \u6ce8\u5165 Store"),l.a.createElement(r["a"],{code:"const ReactReduxContext = React.createContext(null);\nfunction Provider({ store, context, children }) {\n  /* \u5229\u7528useMemo\uff0c\u8ddf\u636estore\u53d8\u5316\u521b\u5efa\u51fa\u4e00\u4e2acontextValue \u5305\u542b\u4e00\u4e2a\u6839\u5143\u7d20\u8ba2\u9605\u5668\u548c\u5f53\u524dstore  */\n  const contextValue = useMemo(() => {\n    /* \u521b\u5efa\u4e86\u4e00\u4e2a\u6839\u7ea7 Subscription \u8ba2\u9605\u5668 */\n    const subscription = new Subscription(store);\n    return {\n      store,\n      subscription,\n    }; /* store \u6539\u53d8\u521b\u5efa\u65b0\u7684contextValue */\n  }, [store]);\n  useEffect(() => {\n    const { subscription } = contextValue;\n    /* \u89e6\u53d1trySubscribe\u65b9\u6cd5\u6267\u884c\uff0c\u521b\u5efalistens */\n    subscription.trySubscribe(); // \u53d1\u8d77\u8ba2\u9605\n    return () => {\n      subscription.tryUnsubscribe(); // \u5378\u8f7d\u8ba2\u9605\n    };\n  }, [contextValue]); /*  contextValue state \u6539\u53d8\u51fa\u53d1\u65b0\u7684 effect */\n  const Context = ReactReduxContext;\n  return <Context.Provider value={contextValue}>{children}</Context.Provider>;\n}",lang:"js"}),l.a.createElement("ul",null,l.a.createElement("li",null,"1.React-Redux \u662f\u901a\u8fc7 ",l.a.createElement("code",null,"context")," \u4e0a\u4e0b\u6587\u6765\u4fdd\u5b58\u4f20\u9012 Store \u7684\uff0c\u4f46\u662f\u4e0a\u4e0b\u6587 value \u4fdd\u5b58\u7684\u9664\u4e86 Store \u8fd8\u6709 ",l.a.createElement("code",null,"subscription")),l.a.createElement("li",null,"2.",l.a.createElement("code",null,"subscription")," \u53ef\u4ee5\u7406\u89e3\u4e3a",l.a.createElement("code",null,"\u8ba2\u9605\u5668"),"\uff0c\u5728 React-redux \u4e2d\u4e00\u65b9\u9762\u7528\u6765\u8ba2\u9605\u6765\u81ea state \u53d8\u5316\uff0c\u53e6\u4e00\u65b9\u9762\u901a\u77e5\u5bf9\u5e94\u7684\u7ec4\u4ef6\u66f4\u65b0\u3002\u5728 Provider \u4e2d\u7684\u8ba2\u9605\u5668 subscription \u4e3a",l.a.createElement("code",null,"\u6839\u8ba2\u9605\u5668")),l.a.createElement("li",null,"3 \u5728 ",l.a.createElement("code",null,"Provider")," \u7684 ",l.a.createElement("code",null,"useEffect")," \u4e2d\uff0c\u8fdb\u884c\u771f\u6b63\u7684",l.a.createElement("code",null,"\u7ed1\u5b9a\u8ba2\u9605\u529f\u80fd"),"\uff0c\u5176\u539f\u7406\u5185\u90e8\u8c03\u7528\u4e86 store.",l.a.createElement("code",null,"subscribe")," \uff0c\u53ea\u6709\u6839\u8ba2\u9605\u5668\u624d\u4f1a\u89e6\u53d1 store.subscribe")),l.a.createElement("h3",{id:"2subscription-\u8ba2\u9605\u5668"},l.a.createElement(c["AnchorLink"],{to:"#2subscription-\u8ba2\u9605\u5668","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2\uff09Subscription \u8ba2\u9605\u5668"),l.a.createElement("p",null,l.a.createElement("img",{src:t("8Kux"),alt:"image"})),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"\u5c42\u5c42\u8ba2\u9605\uff0c\u4e0a\u8ba2\u4e0b\u53d1"))),l.a.createElement(r["a"],{code:"/* \u53d1\u5e03\u8ba2\u9605\u8005\u6a21\u5f0f */\nexport default class Subscription {\n  constructor(store, parentSub) {\n    //....\n  }\n  /* \u8d1f\u8d23\u68c0\u6d4b\u662f\u5426\u8be5\u7ec4\u4ef6\u8ba2\u9605\uff0c\u7136\u540e\u6dfb\u52a0\u8ba2\u9605\u8005\u4e5f\u5c31\u662flistener */\n  addNestedSub(listener) {\n    this.trySubscribe();\n    return this.listeners.subscribe(listener);\n  }\n  /* \u5411listeners\u53d1\u5e03\u901a\u77e5 */\n  notifyNestedSubs() {\n    this.listeners.notify();\n  }\n  /* \u5f00\u542f\u8ba2\u9605\u6a21\u5f0f \u9996\u5148\u5224\u65ad\u5f53\u524d\u8ba2\u9605\u5668\u6709\u6ca1\u6709\u7236\u7ea7\u8ba2\u9605\u5668 \uff0c \u5982\u679c\u6709\u7236\u7ea7\u8ba2\u9605\u5668(\u5c31\u662f\u7236\u7ea7Subscription)\uff0c\u628a\u81ea\u5df1\u7684handleChangeWrapper\u653e\u5165\u5230\u76d1\u542c\u8005\u94fe\u8868\u4e2d */\n  trySubscribe() {\n    /*\n    parentSub  \u5373\u662fprovide value \u91cc\u9762\u7684 Subscription \u8fd9\u91cc\u53ef\u4ee5\u7406\u89e3\u4e3a \u7236\u7ea7\u5143\u7d20\u7684 Subscription\n    */\n    if (!this.unsubscribe) {\n      this.unsubscribe = this.parentSub\n        ? this.parentSub.addNestedSub(this.handleChangeWrapper)\n        : /* provider\u7684Subscription\u662f\u4e0d\u5b58\u5728parentSub\uff0c\u6240\u4ee5\u6b64\u65f6trySubscribe \u5c31\u4f1a\u8c03\u7528 store.subscribe   */\n          this.store.subscribe(this.handleChangeWrapper);\n      this.listeners = createListenerCollection();\n    }\n  }\n  /* \u53d6\u6d88\u8ba2\u9605 */\n  tryUnsubscribe() {\n    //....\n  }\n}",lang:"js"}),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,l.a.createElement("code",null,"\u5c42\u5c42\u8ba2\u9605"),"\uff1a"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u6bcf\u4e00\u4e2a\u7528 connect \u5305\u88c5\u7684\u7ec4\u4ef6\uff0c\u5185\u90e8\u4e5f\u6709\u4e00\u4e2a Subscription \uff0c\u800c\u4e14\u8fd9\u4e9b\u8ba2\u9605\u5668\u4e00\u5c42\u5c42\u5efa\u7acb\u8d77\u5173\u8054"),l.a.createElement("li",null,"Provider \u4e2d\u7684\u8ba2\u9605\u5668\u662f\u6700\u6839\u90e8\u7684\u8ba2\u9605\u5668\uff0c\u53ef\u4ee5\u901a\u8fc7 trySubscribe \u548c addNestedSub \u65b9\u6cd5\u53ef\u4ee5\u770b\u5230"),l.a.createElement("li",null,"\u5982\u679c\u7236\u7ec4\u4ef6\u662f\u4e00\u4e2a connect \uff0c\u5b50\u5b59\u7ec4\u4ef6\u4e5f\u6709 connect \uff0c\u90a3\u4e48\u7236\u5b50 connect \u7684 Subscription \u4e5f\u4f1a\u5efa\u7acb\u8d77\u7236\u5b50\u5173\u7cfb"))),l.a.createElement("li",null,l.a.createElement("p",null,l.a.createElement("code",null,"\u4e0a\u8ba2\u4e0b\u53d1"),"\uff1a"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u5728\u8c03\u7528 trySubscribe \u7684\u65f6\u5019\uff0c\u80fd\u591f\u770b\u5230\u8ba2\u9605\u5668\u4f1a\u548c\u4e0a\u4e00\u7ea7\u7684\u8ba2\u9605\u5668\u901a\u8fc7 ",l.a.createElement("code",null,"addNestedSub \u5efa\u7acb"),"\u8d77",l.a.createElement("code",null,"\u5173\u8054"),"\uff0c\u5f53 store \u4e2d state \u53d1\u751f\u6539\u53d8\uff0c\u4f1a\u89e6\u53d1 store.subscribe \uff0c\u4f46\u662f",l.a.createElement("code",null,"\u53ea\u4f1a\u901a\u77e5\u7ed9 Provider \u4e2d\u7684\u6839 Subscription"),"\uff0c",l.a.createElement("code",null,"\u6839")," Subscription ",l.a.createElement("code",null,"\u4e5f\u4e0d\u4f1a\u76f4\u63a5\u6d3e\u53d1\u66f4\u65b0"),"\uff0c\u800c\u662f",l.a.createElement("code",null,"\u4f1a\u4e0b\u53d1\u7ed9\u5b50\u4ee3\u8ba2\u9605\u5668"),"\uff08 connect \u4e2d\u7684 Subscription \uff09\uff0c\u518d",l.a.createElement("code",null,"\u7531\u5b50\u4ee3\u8ba2\u9605\u5668"),"\uff0c",l.a.createElement("code",null,"\u51b3\u5b9a\u662f\u5426\u66f4\u65b0\u7ec4\u4ef6"),"\uff0c\u5c42\u5c42\u4e0b\u53d1")))),l.a.createElement("h3",{id:"3connect-\u63a7\u5236\u66f4\u65b0"},l.a.createElement(c["AnchorLink"],{to:"#3connect-\u63a7\u5236\u66f4\u65b0","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"3\uff09connect \u63a7\u5236\u66f4\u65b0"),l.a.createElement("ul",null,l.a.createElement("li",null,"1.connect \u4e2d\u6709\u4e00\u4e2a ",l.a.createElement("code",null,"selector")," ,\u901a\u8fc7 mapStateToProps \uff0cmapDispatchToProps \uff0c\u628a redux \u4e2d state \u72b6\u6001",l.a.createElement("code",null,"\u5408\u5e76"),"\u5230 props \u4e2d\uff0c\u5f97\u5230\u6700\u65b0\u7684 props"),l.a.createElement("li",null,"2.\u6bcf\u4e00\u4e2a connect \u90fd\u4f1a",l.a.createElement("code",null,"\u4ea7\u751f"),"\u4e00\u4e2a",l.a.createElement("code",null,"\u65b0\u7684 Subscription")," \uff0c\u548c\u7236\u7ea7\u8ba2\u9605\u5668",l.a.createElement("code",null,"\u5efa\u7acb"),"\u8d77",l.a.createElement("code",null,"\u5173\u8054"),"\uff0c\u8fd9\u6837\u7236\u7ea7\u4f1a\u89e6\u53d1\u5b50\u4ee3\u7684 Subscription \u6765\u5b9e\u73b0",l.a.createElement("code",null,"\u9010\u5c42"),"\u7684\u72b6\u6001",l.a.createElement("code",null,"\u6d3e\u53d1")),l.a.createElement("li",null,"3.Subscription \u901a\u77e5\u7684\u662f checkForUpdates \u51fd\u6570\uff0ccheckForUpdates \u4f1a\u5f62\u6210\u65b0\u7684 props \uff0c\u4e0e\u4e4b\u524d\u7f13\u5b58\u7684 props \u8fdb\u884c\u6d45\u6bd4\u8f83\uff0c\u5982\u679c",l.a.createElement("code",null,"\u4e0d\u76f8\u7b49"),"\uff0c\u90a3\u4e48\u8bf4\u660e state \u5df2\u7ecf\u53d8\u5316\u4e86\uff0c\u76f4\u63a5",l.a.createElement("code",null,"\u89e6\u53d1"),"\u4e00\u4e2a ",l.a.createElement("code",null,"useReducer")," \u6765",l.a.createElement("code",null,"\u66f4\u65b0"),"\u7ec4\u4ef6\uff0c\u5982\u679c",l.a.createElement("code",null,"\u76f8\u7b49"),"\uff0c\u90a3\u4e48\u5f53\u524d\u7ec4\u4ef6",l.a.createElement("code",null,"\u4e0d\u9700\u8981\u66f4\u65b0"),"\uff0c\u76f4\u63a5\u901a\u77e5\u5b50\u4ee3 Subscription \uff0c\u68c0\u67e5\u5b50\u4ee3 Subscription \u662f\u5426\u66f4\u65b0\uff0c\u5b8c\u6210\u6574\u4e2a\u6d41\u7a0b")),l.a.createElement(r["a"],{code:"function connect(mapStateToProps, mapDispatchToProps) {\n  const Context = ReactReduxContext;\n  /* WrappedComponent \u4e3aconnect \u5305\u88f9\u7684\u7ec4\u4ef6\u672c\u8eab  */\n  return function wrapWithConnect(WrappedComponent) {\n    function createChildSelector(store) {\n      /* \u9009\u62e9\u5668  \u5408\u5e76\u51fd\u6570 mergeprops */\n      return selectorFactory(store.dispatch, {\n        mapStateToProps,\n        mapDispatchToProps,\n      });\n    }\n    /* \u8d1f\u8d23\u66f4\u65b0\u7ec4\u4ef6\u7684\u5bb9\u5668 */\n    function ConnectFunction(props) {\n      /* \u83b7\u53d6 context\u5185\u5bb9 \u91cc\u9762\u542b\u6709 redux\u4e2dstore \u548c\u7236\u7ea7subscription */\n      const contextValue = useContext(ContextToUse);\n      /* \u521b\u5efa\u5b50\u9009\u62e9\u5668,\u7528\u4e8e\u63d0\u53d6state\u4e2d\u7684\u72b6\u6001\u548cdispatch\u6620\u5c04\uff0c\u5408\u5e76\u5230props\u4e2d */\n      const childPropsSelector = createChildSelector(contextValue.store);\n      const [subscription, notifyNestedSubs] = useMemo(() => {\n        /* \u521b\u5efa\u4e00\u4e2a\u5b50\u4ee3Subscription\uff0c\u5e76\u548c\u7236\u7ea7subscription\u5efa\u7acb\u8d77\u5173\u7cfb */\n        const subscription = new Subscription(\n          store,\n          didStoreComeFromProps ? null : contextValue.subscription, // \u7236\u7ea7subscription\uff0c\u901a\u8fc7\u8fd9\u4e2a\u548c\u7236\u7ea7\u8ba2\u9605\u5668\u5efa\u7acb\u8d77\u5173\u8054\u3002\n        );\n        return [subscription, subscription.notifyNestedSubs];\n      }, [store, didStoreComeFromProps, contextValue]);\n\n      /* \u5408\u6210\u7684\u771f\u6b63\u7684props */\n      const actualChildProps = childPropsSelector(\n        store.getState(),\n        wrapperProps,\n      );\n      const lastChildProps = useRef();\n      /* \u66f4\u65b0\u51fd\u6570 */\n      const [forceUpdate] = useState(0);\n      useEffect(() => {\n        const checkForUpdates = () => {\n          newChildProps = childPropsSelector();\n          if (newChildProps === lastChildProps.current) {\n            /* \u8ba2\u9605\u7684state\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u90a3\u4e48\u8be5\u7ec4\u4ef6\u4e0d\u9700\u8981\u66f4\u65b0\uff0c\u901a\u77e5\u5b50\u4ee3\u8ba2\u9605\u5668 */\n            notifyNestedSubs();\n          } else {\n            /* \u8fd9\u4e2a\u624d\u662f\u771f\u6b63\u7684\u89e6\u53d1\u7ec4\u4ef6\u66f4\u65b0\u7684\u51fd\u6570 */\n            forceUpdate((state) => state + 1);\n            lastChildProps.current = newChildProps; /* \u4fdd\u5b58\u4e0a\u4e00\u6b21\u7684props */\n          }\n        };\n        subscription.onStateChange = checkForUpdates;\n        //\u5f00\u542f\u8ba2\u9605\u8005 \uff0c\u5f53\u524d\u662f\u88abconnect \u5305\u8f6c\u7684\u60c5\u51b5 \u4f1a\u628a \u5f53\u524d\u7684 checkForceUpdate \u653e\u5728\u5b58\u5165 \u7236\u5143\u7d20\u7684addNestedSub\u4e2d \uff0c\u4e00\u70b9\u70b9\u5411\u4e0a\u7ea7\u4f20\u9012 \u6700\u540e\u4f20\u5230 provide\n        subscription.trySubscribe();\n        /* \u5148\u68c0\u67e5\u4e00\u904d\uff0c\u53cd\u6b63\u521d\u59cb\u5316state\u5c31\u53d8\u4e86 */\n        checkForUpdates();\n      }, [store, subscription, childPropsSelector]);\n\n      /* \u5229\u7528 Provider \u7279\u6027\u9010\u5c42\u4f20\u9012\u65b0\u7684 subscription */\n      return (\n        <ContextToUse.Provider value={{ ...contextValue, subscription }}>\n          <WrappedComponent {...actualChildProps} />\n        </ContextToUse.Provider>\n      );\n    }\n    /* memo \u4f18\u5316\u5904\u7406 */\n    const Connect = React.memo(ConnectFunction);\n    return hoistStatics(Connect, WrappedComponent); /* \u7ee7\u627f\u9759\u6001\u5c5e\u6027 */\n  };\n}",lang:"js"}),l.a.createElement("h2",{id:"9\u5b9e\u73b0\u5f02\u6b65"},l.a.createElement(c["AnchorLink"],{to:"#9\u5b9e\u73b0\u5f02\u6b65","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"9.\u5b9e\u73b0\u5f02\u6b65"),l.a.createElement("h3",{id:"1redux-thunk"},l.a.createElement(c["AnchorLink"],{to:"#1redux-thunk","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"1\uff09redux-thunk"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u4ee3\u7801\u91cf\u5c11\uff0c\u53ea\u6709\u51e0\u884c\uff0c\u5176\u4e2d\u5927\u91cf\u7684\u903b\u8f91\u9700\u8981\u5f00\u53d1\u8005\u5b9e\u73b0")),l.a.createElement("h3",{id:"2redux-saga"},l.a.createElement(c["AnchorLink"],{to:"#2redux-saga","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"2\uff09redux-saga"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u57fa\u4e8e generator \u5b9e\u73b0\uff0c\u7528\u8d77\u6765\u7a0d\u5fae\u7e41\u7410")),l.a.createElement("h3",{id:"3dvajs"},l.a.createElement(c["AnchorLink"],{to:"#3dvajs","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"3\uff09dvajs"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u57fa\u4e8e redux-saga \u57fa\u7840\u4e0a\uff0c\u5b9e\u73b0\u7684\u5f02\u6b65\u7684\u72b6\u6001\u7ba1\u7406\u5de5\u5177")))))},"8Kux":function(e,n,t){e.exports=t.p+"static/9.49545074.png"},JjdP:function(e,n,t){"use strict";t.r(n),n["default"]={}},"L/18":function(e,n,t){e.exports=t.p+"static/7.8516a814.png"},M7xk:function(e,n,t){e.exports=t.p+"static/8.4154df74.png"},Zs1V:function(e){e.exports=JSON.parse("{}")}}]);